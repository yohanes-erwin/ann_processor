`timescale 1ns / 1ps

module axis_ann_tb();
    localparam T = 10;
    
    reg aclk;
    reg aresetn;
    
    wire s_axis_tready;
    reg [127:0] s_axis_tdata;
    reg s_axis_tvalid;
    reg s_axis_tlast;
    
    reg m_axis_tready;
    wire [127:0] m_axis_tdata;
    wire m_axis_tvalid;
    wire m_axis_tlast;
    
    axis_ann dut
    (
        .aclk(aclk),
        .aresetn(aresetn),
        .s_axis_tready(s_axis_tready),
        .s_axis_tdata(s_axis_tdata),
        .s_axis_tvalid(s_axis_tvalid),
        .s_axis_tlast(s_axis_tlast),
        .m_axis_tready(m_axis_tready),
        .m_axis_tdata(m_axis_tdata),
        .m_axis_tvalid(m_axis_tvalid),
        .m_axis_tlast(m_axis_tlast)
    );
    
    always
    begin
        aclk = 0;
        #(T/2);
        aclk = 1;
        #(T/2);
    end

    initial
    begin
        s_axis_tdata = 0;
        s_axis_tvalid = 0;
        s_axis_tlast = 0;
        m_axis_tready = 1;
        
        aresetn = 0;
        #(T*5);
        aresetn = 1;
        #(T*5);
        
        // *** Testvector 1 ***
        s_axis_tvalid = 1;
        // Weight and bias
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111101011001100_1111101011001100_0000011011001100_0000010100110011_1111101100110011;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110000000000_0000010000000000_0000000011001100_0000001000000000_0000000100110011;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110000000000_0000011000000000_0000001100110011_0000000001100110_0000001001100110;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110001100110_0000010100110011_1111101001100110_1111101100110011_0000010100110011;
        #T; 
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110000000000_0000000110011001_0000001000000000_0000000100110011_0000010100110011;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_1111101000000000_0000000001100110_1111001000000000_0000001100110011_1111111011001100_0001010011001100;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_1111101001100110_0000001110011001_0001000000000000_0000001011001100_0000000001100110_1110110011001100;
        #T;   
        // Input
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000110000000000_0001100000000000_0000110000000000_0001100000000000_0001110000000000_0000100000000000;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000100000000000_0010010000000000_0010100000000000_0010000000000000_0000100000000000_0010100000000000;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0001100000000000_0001010000000000_0000110000000000_0000010000000000_0000110000000000_0001010000000000;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0010100000000000_0001100000000000_0000010000000000_0001100000000000_0000110000000000_0000110000000000;
        s_axis_tlast = 1;
        #T;
        s_axis_tvalid = 0;
        s_axis_tdata = 0; 
        s_axis_tlast = 0;
        #(T*100);
        
        // *** Testvector 2 ***
        s_axis_tvalid = 1;
        // Weight and bias
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111101011001100_1111101011001100_0000011011001100_0000010100110011_1111101100110011;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110000000000_0000010000000000_0000000011001100_0000001000000000_0000000100110011;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110000000000_0000011000000000_0000001100110011_0000000001100110_0000001001100110;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110001100110_0000010100110011_1111101001100110_1111101100110011_0000010100110011;
        #T; 
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000000000000000_1111110000000000_0000000110011001_0000001000000000_0000000100110011_0000010100110011;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_1111101000000000_0000000001100110_1111001000000000_0000001100110011_1111111011001100_0001010011001100;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_1111101001100110_0000001110011001_0001000000000000_0000001011001100_0000000001100110_1110110011001100;
        #T;   
        // Input
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000110000000000_0001100000000000_0000110000000000_0001100000000000_0001110000000000_0000100000000000;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0000100000000000_0010010000000000_0010100000000000_0010000000000000_0000100000000000_0010100000000000;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0001100000000000_0001010000000000_0000110000000000_0000010000000000_0000110000000000_0001010000000000;
        #T;
        s_axis_tdata = 128'b0000000000000000_0000000000000000_0010100000000000_0001100000000000_0000010000000000_0001100000000000_0000110000000000_0000110000000000;
        s_axis_tlast = 1;
        #T;
        s_axis_tvalid = 0;
        s_axis_tdata = 0; 
        s_axis_tlast = 0;
        #(T*100);
    end
        
endmodule
